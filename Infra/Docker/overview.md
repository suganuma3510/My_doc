- [Dockerとは](#dockerとは)
  - [コンテナ型](#コンテナ型)
    - [メリット](#メリット)
    - [デメリット](#デメリット)
    - [特徴](#特徴)
  - [Dockerfile](#dockerfile)
  - [Dockerイメージ](#dockerイメージ)
  - [コンテナイメージとは](#コンテナイメージとは)
  - [コンテナランタイムとは](#コンテナランタイムとは)
  - [コンテナレジストリとは](#コンテナレジストリとは)
  - [イメージレイヤとは](#イメージレイヤとは)
  - [コンテナレイヤとは](#コンテナレイヤとは)
  - [参考](#参考)

## Dockerとは
Docker社が開発している、コンテナ型の仮想環境を作成、配布、実行するためのプラットフォーム。  
コンテナ型のアプリケーション実行環境のこと。Linux上で動作する。（WindowsやMacでは裏でLinuxの仮想環境が構築されている）
以下はDockerを理解するうえで重要な知識をまとめたもの。

### コンテナ型
現在の主流。アプリケーション・ミドルウェア・OSなどのインフラ環境を一つのコンテナとしてまとめる。  
それぞれのコンテナがホストOSを共有して稼働するため、他の仮想化と比べるとサーバの起動や処理なども高速。  
ホストOSと異なるOSのコンテナを作ることができない。

![コンテナ型とハイパーバイザ型の違い](https://user-images.githubusercontent.com/57606507/143512370-e11707a9-bb71-4f1a-8f5f-4b78f7eb402c.png)

仮想化ソフトウェアの例：Dockerなど

#### メリット
- ビルド、デプロイも高速
- オーバーヘッドが少ない
- プラットフォームやハードウェアからの隔離環境
- ラップトップで動いているものをそのままサーバに持っていける
- 環境の配布・共有がしやすい
- 軽量なためリソースの利用効率が高い

#### デメリット
- ホストOSと異なるOSを使用することはできない  
LinuxまたはLinuxディストリビューションに分類されるOSのみしか使用できない

#### 特徴
- 開発環境を共有できる
- Docker Hubと呼ばれるレジストリがある
- ホストがライブラリやミドルウェアで汚れない

dockerが利用されているサービス
AbemaTV・アメーバブログ・Pokemon Goなど

### Dockerfile
DockerfileとはDocker上で動作させるコンテナの構成情報をコードで記述されたファイルのこと。
DockerfileをもとにビルドすることでDockerイメージを作成することができる。

### Dockerイメージ
コンテナの実行に必要な概念としてのパッケージ（ファイルやメタ情報の集合体）のこと。Linuxのファイルシステムやアプリケーション（ソースコード等）、実行するコマンドや引数、公開するポート番号等の情報を持っている。また、それらの情報を含んだ複数のイメージレイヤによって構成されている。

### コンテナイメージとは
コンテナの実行に必要な概念としてのパッケージ（ファイルやメタ情報の集合体）のこと。Dockerイメージとほぼ同じ意味。

### コンテナランタイムとは
コンテナの実行に関する各種設定情報を受け取ってコンテナを作成・実行・停止・削除するソフトウェアのこと。

### コンテナレジストリとは
コンテナイメージファイルを保管する場所、またコンテナイメージのバージョン管理や配布を行えるサービスのこと。  
例：Docker Hub、GitHub Packages Container registryなど

### イメージレイヤとは
イメージを構成する読み込み専用レイヤのこと。  
各レイヤは、その直前のレイヤからの差異だけを保持し、レイヤは順に積み上げられていく。

### コンテナレイヤとは
コンテナ上の読み書き可能なレイヤのこと。  
新しいコンテナを生成したときには、それまで存在していたレイヤ群の最上部に、新たな書き込み可能なレイヤが加えられる。

実行中のコンテナに対して実行される変更処理すべて、たとえば新規ファイル生成、既存ファイル修正、ファイル削除といったことは、書き込み可能なコンテナ・レイヤに対して書き込まれる。

コンテナが削除されると、その書き込みレイヤも同じく削除されるが、元にあったイメージは変更されずに残る。

### 参考
- [イメージ、コンテナ、ストレージ・ドライバについて — Docker\-docs\-ja 17\.06 ドキュメント](https://docs.docker.jp/v17.06/engine/userguide/storagedriver/imagesandcontainers.html)
- [Dockerイメージのレイヤの考え方とイメージの軽量化について \- ネットワークエンジニアを目指して](https://www.itbook.info/network/docker02.html)
- [Dockerイメージの理解を目指すチュートリアル \- Qiita](https://qiita.com/zembutsu/items/24558f9d0d254e33088f)